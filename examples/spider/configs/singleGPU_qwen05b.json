{
  "algorithm": {
    "adv_estimator": "grpo",
    "use_kl_in_reward": false
  },
  "data": {
    "train_files": "data/train_spider.parquet",
    "val_files": "data/test_dev.parquet",
    "train_batch_size": 16,
    "max_prompt_length": 4096,
    "max_response_length": 2048,
    "truncation": "error"
  },
  "actor_rollout_ref": {
    "rollout": {
      "tensor_model_parallel_size": 1,
      "n": 4,
      "log_prob_micro_batch_size_per_gpu": 2,
      "multi_turn": {
        "format": "hermes"
      },
      "name": "vllm",
      "gpu_memory_utilization": 0.4,
      "engine_kwargs": {
        "vllm": {
          "enable_auto_tool_choice": true,
          "tool_call_parser": "hermes"
        }
      }
    },
    "actor": {
      "ppo_mini_batch_size": 16,
      "ppo_micro_batch_size_per_gpu": 2,
      "optim": {
        "lr": 1e-06
      },
      "use_kl_loss": false,
      "kl_loss_coef": 0.0,
      "entropy_coeff": 0,
      "clip_ratio_low": 0.2,
      "clip_ratio_high": 0.3,
      "fsdp_config": {
        "param_offload": false,
        "optimizer_offload": true
      }
    },
    "ref": {
      "log_prob_micro_batch_size_per_gpu": 2,
      "fsdp_config": {
        "param_offload": true
      }
    },
    "model": {
      "path": "/home/lthpc/student/LiTengfei/LLaMA-Factory/models/Qwen2.5-Coder-0.5B-Instruct",
      "use_remove_padding": true,
      "enable_gradient_checkpointing": true
    }
  },
  "trainer": {
    "n_gpus_per_node": 1,
    "val_before_train": false,
    "critic_warmup": 0,
    "logger": [
      "console",
      "wandb"
    ],
    "project_name": "AgentLightning",
    "experiment_name": "spider",
    "nnodes": 1,
    "test_freq": 500,
    "total_epochs": 2,
    "log_interval": 1,
    "save_freq": 500,
    "default_local_dir": "/home/lthpc/student/LiTengfei/project/myfork/agent-lightning/examples/spider/ckpt_0.5b_grpo_config1"
  }
}
